(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6990],{1554:(e,n,s)=>{"use strict";s.r(n),s.d(n,{default:()=>d,useTOC:()=>a});var i=s(7876),t=s(1807),r=s(3527),l=s(9707);let o={src:"/_next/static/media/Screen Shot 2023-03-17 at 17.06.43.f92d9f76.png",height:355,width:1611,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAACCAMAAABSSm3fAAAABlBMVEX5+vz+/v42rl0PAAAACXBIWXMAAAsTAAALEwEAmpwYAAAADklEQVR4nGNggANGCAAAAC4ACOhM71UAAAAASUVORK5CYII=",blurWidth:8,blurHeight:2};function a(e){return[{value:"Configure subdomains for ChatPlus server",id:"configure-subdomains-for-chatplus-server",depth:2},{value:"Set up Chat",id:"set-up-chat",depth:2},{value:"Start Chat server",id:"start-chat-server",depth:4},{value:"Configure ChatPlus on MetaFox site",id:"configure-chatplus-on-metafox-site",depth:2},{value:"Set up folders and environments for built-in Call feature (Optional)",id:"set-up-folders-and-environments-for-built-in-call-feature-optional",depth:2},{value:"Enable Jitsi JWT\xa0",id:"enable-jitsi-jwt",depth:3},{value:"Change default Jitsi web configs",id:"change-default-jitsi-web-configs",depth:3},{value:"Update Jitsi web images/logos",id:"update-jitsi-web-imageslogos",depth:3}]}let d=(0,t.e)(function(e){let{toc:n=a(e)}=e,s={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(s.h1,{children:"Set up ChatPlus server"}),"\n",(0,i.jsx)(s.p,{children:"This article will guide you to set up ChatPlus on your server by yourself. In this article, we assume that you are already familiar with\xa0 Linux server management and docker, know how to use terminal, access SSH with root/super users privileges and set up necessary software such as Git, Docker, NginX/Apache as Reverse proxy, etc."}),"\n",(0,i.jsx)(s.p,{children:"If you aren’t familiar with setting up ChatPlus server, please feel free to open ticket to request our support. You aren’t charged any fee for the 1st setup."}),"\n",(0,i.jsx)(s.p,{children:"Firstly, you will need to install and run following software on your Linux server:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Docker and Docker-compose"}),"\n",(0,i.jsx)(s.li,{children:"NginX or Apache (as Reverse Proxy)"}),"\n",(0,i.jsx)(s.li,{children:"Git"}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:"Then, let’s start setting up ChatPlus server"}),"\n",(0,i.jsx)(s.h2,{id:n[0].id,children:n[0].value}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Create 2 different domains or subdomains for chat and call features, such as ",(0,i.jsx)(s.a,{href:"http://chat.yourdomain.com",children:"chat.yourdomain.com"})," and ",(0,i.jsx)(s.a,{href:"http://voip.yourdomain.com",children:"voip.yourdomain.com"})]}),"\n",(0,i.jsxs)(s.li,{children:["Configure these 2 domains/subdomains above with Reverse Proxy server (NginX or Apache) for Websocket.","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsx)(s.li,{children:"Set up SSL for domain/subdomain"}),"\n",(0,i.jsxs)(s.li,{children:["For Chat domain/subdomain, configure to proxy requests to port 3000 (default Port of Chatplus), such as\xa0",(0,i.jsx)(s.a,{href:"http://127.0.0.1:3000",children:"http://127.0.0.1:3000"}),"\xa0. You can use another port for Chatplus, but will need to update this port into ",(0,i.jsx)(s.code,{children:"docker-compose.yml"})," file and ",(0,i.jsx)(s.code,{children:"chatplus.env"})," file for Chat as described later."]}),"\n",(0,i.jsxs)(s.li,{children:["For Call domain/subdomain, configure to proxy requests to port 8443 (default port of Call feature), such as\xa0",(0,i.jsx)(s.a,{href:"https://127.0.0.1:8443",children:"https://127.0.0.1:8443"}),"\xa0.\xa0\xa0You can use another port for Call feature but will need to follow guide to configure this port for Call/VoIP server as described later."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:n[1].id,children:n[1].value}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Create main folder for Chat, such as at ",(0,i.jsx)(s.code,{children:"/var/www/chatplus/chat"})]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Go to the main folder for Chat, run following command to download the ",(0,i.jsx)(s.code,{children:"docker-compose.yml"})," file and ",(0,i.jsx)(s.code,{children:"chatplus.env"})]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["After the command runs completely, you will see that 2 files are downloaded into the folder: ",(0,i.jsx)(s.code,{children:"docker-compose.yaml"})," and ",(0,i.jsx)(s.code,{children:"chatplus.env"})," ."]}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["If you use another custom port instead of the default port 3000, you will need to update port custom port in the ",(0,i.jsx)(s.code,{children:"docker-compose.yaml"})]}),"\n",(0,i.jsxs)(s.li,{children:["Open ",(0,i.jsx)(s.code,{children:"chatplus.env"})," and update environment variables for Chat as below. Then, save it."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h4,{id:n[2].id,children:n[2].value}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Run following command\xa0to download/update docker images and run docker containers"}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Once Chatplus docker containers are running properly, you will check to see if the Setup page is working at\xa0",(0,i.jsx)(s.a,{href:"https://chat.youdomain.com",children:"https://chat.youdomain.com"}),"\xa0. However, you don’t need to proceed with any setup steps there at this time. It will be done automatically while configuring in AdminCP of MetaFox site."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:n[3].id,children:n[3].value}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["Install ",(0,i.jsx)(s.strong,{children:"ChatPlus"})," app in your AdminCP (After purchasing the Chatplus solution, you should see the ChatPlus app under AdminCP > Apps > Purchased. If the ChatPlus app isn’t available there, please feel free to open a Support ticket in ",(0,i.jsx)(s.a,{href:"https://clients.phpfox.com/",children:"Client Area"}),".)"]}),"\n",(0,i.jsx)(s.li,{children:"Go to the AdminCP > App Settings > ChatPlus page"}),"\n",(0,i.jsxs)(s.li,{children:["In ",(0,i.jsx)(s.strong,{children:"Settings"}),", configure the following settings and save them:","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Server"}),": it is the URL of domain/subdomain for chat. In our example, it is “",(0,i.jsx)(s.a,{href:"https://chat.yourdomain.com",children:"https://chat.yourdomain.com"}),"”.\xa0"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"ChatPlus Secret Code"}),": configure the same string as configured for SECRET_CODE in ",(0,i.jsx)(s.code,{children:"chatplus.env"})," file"]}),"\n",(0,i.jsx)(s.li,{children:"Configure iOS settings for push notification on your iOS app such as iOS bundle ID, APN Key and APN Key ID, Apple Team ID."}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.strong,{children:"Select Video Bridge Service:"}),"\xa0you can choose “Free Video Bridge Service” or “phpFox Video Bridge Service” for now. You can set up your self-host call service and configure all related settings later.","\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["With ",(0,i.jsx)(s.em,{children:"Free Video Bridge Service"}),", the Call will use free service for Jitsi Meet"]}),"\n",(0,i.jsxs)(s.li,{children:["With ",(0,i.jsx)(s.em,{children:"phpFox Video Bridge service"}),", the service is provided by phpFox with limited usage."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["In ",(0,i.jsx)(s.strong,{children:"Sync Users"}),", click on the Sync Users to sync users from MetaFox site to Chatplus manually. ChatPlus server will need to get details of existing users at the 1st setup time. New signup or changes on user details then will be synced automatically."]}),"\n"]}),"\n",(0,i.jsx)(s.h2,{id:n[4].id,children:n[4].value}),"\n",(0,i.jsxs)(s.p,{children:["Chatplus server supports and can use the default VoIP server of\xa0",(0,i.jsx)(s.a,{href:"https://meet.jit.si/",children:"Jitsi"}),"\xa0to make voice/video calls.\xa0For better performance, please set up this ",(0,i.jsx)(s.strong,{children:"separately"})," with ChatPlus server. You can find the full guide ",(0,i.jsx)(s.a,{href:"https://jitsi.github.io/handbook/docs/devops-guide/devops-guide-docker",children:"here"})]}),"\n",(0,i.jsx)(s.p,{children:"Once, Jitsi VoIP server is installed completely. You will need to update some configuration to update Jitsi branding with your own branding. Please replace the phrases with square blanket\xa0[] by respective value"}),"\n",(0,i.jsx)(s.h3,{id:n[5].id,children:n[5].value}),"\n",(0,i.jsx)(s.p,{children:"To secure VoIP server to accept calls from your phpFox site only, you will need to enable Jitsi JWT as below:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Go to ",(0,i.jsx)(s.code,{children:"voip_folder/.env"})," and change all of these"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Delete folder ~/.jitsi-meet-config/\xa0and restart VoIP docker again."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Also, you will need to enable JWT Authentication and configure same values of\xa0JWT_APP_ID and\xa0JWT_APP_SECRET in the AdminCP > Apps > ChatPlus > Settings page"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(s.p,{children:(0,i.jsx)(s.img,{alt:"Screen Shot 2023-03-17 at 17.06.43.png",placeholder:"blur",src:o})}),"\n",(0,i.jsx)(s.h3,{id:n[6].id,children:n[6].value}),"\n",(0,i.jsxs)(s.p,{children:["Go to ",(0,i.jsx)(s.code,{children:"~/.jitsi-meet-config/web"})," and change these in file ",(0,i.jsx)(s.code,{children:"interface_config.js"})," :"]}),"\n",(0,i.jsx)(s.h3,{id:n[7].id,children:n[7].value}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Run “docker ps” to get the running container ID of jiti-web."}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsxs)(s.p,{children:["Access docker container of ",(0,i.jsx)(s.code,{children:"jiti-web"})," service :"]}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Go to directory:"}),"\n"]}),"\n",(0,i.jsxs)(s.li,{children:["\n",(0,i.jsx)(s.p,{children:"Replace any image/logs you want to:"}),"\n",(0,i.jsxs)(s.ul,{children:["\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"watermark.png"})," -> watermark image when user is in call/voice if flag SHOW_JITSI_WATERMARK is true"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"logo-deep-linking.png"})," -> image at on top when deep linking page is showed (No mobile app installed) when flag MOBILE_APP_PROMO is true"]}),"\n",(0,i.jsxs)(s.li,{children:[(0,i.jsx)(s.code,{children:"jitsiLogo.png"}),", ",(0,i.jsx)(s.code,{children:"JitsiLogo_square.png"})]}),"\n"]}),"\n"]}),"\n"]})]})},"/set-up-community/set-up-chatplus-solution/set-up-chatplus-server",{filePath:"pages/set-up-community/set-up-chatplus-solution/set-up-chatplus-server.mdx",timestamp:1770628094e3,pageMap:r.O,frontMatter:{title:"Set up ChatPlus server"},title:"Set up ChatPlus server"},"undefined"==typeof RemoteContent?a:RemoteContent.useTOC)},4728:(e,n,s)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/set-up-community/set-up-chatplus-solution/set-up-chatplus-server",function(){return s(1554)}])}},e=>{e.O(0,[1807,3527,636,6593,8792],()=>e(e.s=4728)),_N_E=e.O()}]);